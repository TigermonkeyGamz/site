<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rynara Skill Tree</title>

<style>
body{
  margin:0;
  background:#111;
  font-family:sans-serif;
  overflow:hidden;
}

/* Viewport (camera window) */
#viewport{
  width:100vw;
  height:100vh;
  cursor:grab;
  position:relative;
  overflow:hidden;
}

/* World container */
#world{
  position:absolute;
  left:50%;
  top:50%;
  transform-origin:0 0;
}

/* Skills */
.skill{
  position:absolute;
  background:#222;
  border-radius:50%;
  cursor:pointer;
  user-select:none;
  transition:.2s;
  box-shadow:0 0 10px rgba(255,255,255,0.3);
  display:flex;
  align-items:center;
  justify-content:center;
  border:4px solid #555;
}

.skill:hover{
  background:#444;
  box-shadow:0 0 15px #fff;
}

.unlocked{
  background:#d4a526!important;
  box-shadow:0 0 20px gold;
}

.line{
  position:absolute;
  height:2px;
  background:#fff;
  transform-origin:left center;
  z-index:-1;
}

.tooltip{
  position:absolute;
  background:rgba(0,0,0,.85);
  color:#fff;
  padding:6px 10px;
  border-radius:5px;
  pointer-events:none;
  font-size:14px;
  white-space:nowrap;
  display:none;
}

#skill-points{
  position:absolute;
  top:10px;
  left:10px;
  color:#fff;
  font-size:18px;
  background:#222;
  padding:5px 10px;
  border-radius:5px;
  box-shadow:0 0 10px #000;
  z-index:999;
}

#grid{
  position:absolute;
  left:-2000px;
  top:-2000px;
  width:4000px;
  height:4000px;
  z-index:-2;
}
</style>
</head>

<body>

<div id="skill-points">Skill Points: <span id="sp-count">10</span></div>

<div id="viewport">
  <div id="world">
    <canvas id="grid"></canvas>
  </div>
</div>

<div class="tooltip" id="tooltip"></div>

<script>
let sp = 10;

const viewport = document.getElementById('viewport');
const world = document.getElementById('world');
const tooltip = document.getElementById('tooltip');
const spCount = document.getElementById('sp-count');

const gridCanvas = document.getElementById('grid');
const gridCtx = gridCanvas.getContext('2d');

let cameraX = 0;
let cameraY = 0;
let zoom = 1;

let dragging = false;
let lastX=0,lastY=0;

/* ======================
   SKILL DATA
====================== */
const skillData = [
  { id:'skill1',name:'Way of the Warrior',desc:'Increased Melee Damage.<br>Skill: Spin',cost:2,parent:null,x:-200,y:0,size:40,borderColor:'#FF0000'},
  { id:'skill2',name:'Shield Wall',desc:'Block incoming attacks.',cost:3,parent:'skill1',x:-350,y:-70,size:70,borderColor:'#00FF00'},
  { id:'skill3',name:'Earth Slam',desc:'Crush enemies around you.',cost:2,parent:'skill1',x:-350,y:70,size:70,borderColor:'#0000FF'},
  { id:'skill4',name:'War Cry',desc:'Buff allies.',cost:1,parent:'skill3',x:200,y:150,size:70,borderColor:'#FFFF00'}
];

/* ======================
   GRID
====================== */
function drawGrid(){
  gridCanvas.width=4000;
  gridCanvas.height=4000;
  gridCtx.clearRect(0,0,4000,4000);

  gridCtx.strokeStyle='#333';
  gridCtx.fillStyle='#555';
  gridCtx.font='12px sans-serif';

  const step=100;
  const center=2000;

  for(let x=0;x<=4000;x+=step){
    gridCtx.beginPath();
    gridCtx.moveTo(x,0);
    gridCtx.lineTo(x,4000);
    gridCtx.stroke();
    gridCtx.fillText(x-center,x+2,center+12);
  }

  for(let y=0;y<=4000;y+=step){
    gridCtx.beginPath();
    gridCtx.moveTo(0,y);
    gridCtx.lineTo(4000,y);
    gridCtx.stroke();
    gridCtx.fillText(center-y,center+2,y-2);
  }
}

/* ======================
   CREATE SKILLS
====================== */
skillData.forEach(skill=>{
  const div=document.createElement('div');
  div.className='skill';
  div.id=skill.id;

  div.style.left=skill.x+'px';
  div.style.top=skill.y+'px';
  div.style.width=skill.size+'px';
  div.style.height=skill.size+'px';
  div.style.borderColor=skill.borderColor;

  world.appendChild(div);

  div.onmouseover=e=>{
    tooltip.style.display='block';
    tooltip.innerHTML=`<b>${skill.name}</b><br>${skill.desc}<br>SP Cost: ${skill.cost}`;
  };
  div.onmousemove=e=>{
    tooltip.style.left=e.pageX+15+'px';
    tooltip.style.top=e.pageY+15+'px';
  };
  div.onmouseout=()=>tooltip.style.display='none';

  div.onclick=()=>{
    if(div.classList.contains('unlocked'))return;
    if(sp>=skill.cost){
      sp-=skill.cost;
      spCount.textContent=sp;
      div.classList.add('unlocked');
      drawLines();
    }
  };
});

/* ======================
   LINES
====================== */
function drawLines(){
  world.querySelectorAll('.line').forEach(l=>l.remove());

  skillData.forEach(skill=>{
    if(!skill.parent)return;

    const parent=document.getElementById(skill.parent);
    const child=document.getElementById(skill.id);

    const px=parent.offsetLeft+parent.offsetWidth/2;
    const py=parent.offsetTop+parent.offsetHeight/2;
    const cx=child.offsetLeft+child.offsetWidth/2;
    const cy=child.offsetTop+child.offsetHeight/2;

    const dx=cx-px;
    const dy=cy-py;
    const len=Math.sqrt(dx*dx+dy*dy);
    const angle=Math.atan2(dy,dx)*180/Math.PI;

    const line=document.createElement('div');
    line.className='line';
    line.style.width=len+'px';
    line.style.left=px+'px';
    line.style.top=py+'px';
    line.style.transform=`rotate(${angle}deg)`;

    world.appendChild(line);
  });
}

/* ======================
   CAMERA PAN
====================== */
viewport.addEventListener('mousedown',e=>{
  dragging=true;
  viewport.style.cursor='grabbing';
  lastX=e.clientX;
  lastY=e.clientY;
});

window.addEventListener('mouseup',()=>{
  dragging=false;
  viewport.style.cursor='grab';
});

window.addEventListener('mousemove',e=>{
  if(!dragging)return;
  cameraX+=e.clientX-lastX;
  cameraY+=e.clientY-lastY;
  lastX=e.clientX;
  lastY=e.clientY;
  updateCamera();
});

/* ======================
   ZOOM
====================== */
viewport.addEventListener('wheel',e=>{
  e.preventDefault();

  const zoomFactor=1.1;
  zoom*= e.deltaY<0 ? zoomFactor : 1/zoomFactor;

  zoom=Math.min(Math.max(zoom,0.3),3);

  updateCamera();
},{passive:false});

/* ======================
   APPLY CAMERA
====================== */
function updateCamera(){
  world.style.transform=
    `translate(${cameraX}px,${cameraY}px) scale(${zoom})`;
}

/* ======================
   INIT
====================== */
drawGrid();
drawLines();
updateCamera();
</script>
</body>
</html>
